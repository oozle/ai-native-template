# AI-Native Template  

> **A reference implementation to help websites and APIs get fairly compensated when AI systems use their content.**

---

## ğŸŒ What Problem Are We Solving?  

Today, AI agents (like chatbots, search engines, and assistants) read and use huge amounts of online content â€” articles, data, APIs â€” without asking permission, showing ads, or paying the publisher.  

For publishers and API providers, this means:  
- **Lost revenue** â€“ traffic and ad income drop when users get answers directly from AI.  
- **No transparency** â€“ itâ€™s impossible to know who used your content, when, or how much.  
- **No way to enforce terms** â€“ publishers can publish content, but canâ€™t attach â€œrulesâ€ that AI systems respect.  

This project tackles that gap by giving websites and APIs a **simple, machine-readable way to say:**  
- â€œHere are my terms.â€  
- â€œHereâ€™s what it costs for AI to use my data.â€  
- â€œHereâ€™s a signed receipt proving usage.â€  

In plain terms: itâ€™s like adding a **price tag and a receipt printer** to your website or API, so AI agents can consume your content **fairly and transparently** instead of for free.  

---

## âœ¨ What This Is  

AI-Native Template is an **open-source adapter kit** that:  
- Publishes **licensing & pricing manifests** (machine-readable JSON).  
- Issues **signed usage receipts** so AI agents can prove they paid.  
- Provides **schemas, validators, and verifier code** for easy adoption.  
- Includes **edge enforcement examples** (Cloudflare, NGINX) to block unpaid crawlers.  

This project is not a company product â€” itâ€™s a **community reference implementation** intended to accelerate adoption of AI-native compensation standards.  

---

## ğŸš€ Quickstart

### 1. Clone the repo
```bash
git clone https://github.com/oozle/ai-native-template.git
cd ai-native-template
```

### 2. Prerequisites

#### On macOS (Homebrew)
```bash
# Node + npm (for AJV validation)
brew install node

# Python 3 + pip (for verifier + signer)
brew install python3
pip3 install pynacl
```

#### On Windows (PowerShell / winget)
```powershell
# Node + npm
winget install OpenJS.NodeJS

# Python 3 + pip
winget install Python.Python.3.11
pip install pynacl
```

#### On Linux (Debian/Ubuntu)
```bash
sudo apt update
sudo apt install -y nodejs npm python3 python3-pip
pip3 install pynacl
```

---

### 3. Validate against schema (AJV)

Install dependencies:
```bash
npm install -D ajv-cli@5 ajv@^8 ajv-formats
```

Validate the sample fee manifest:
```bash
npx ajv validate --spec=draft2020 -s schemas/apifee.schema.json -d apifee.json -c ajv-formats
```

Validate the sample receipt:
```bash
npx ajv validate --spec=draft2020 -s schemas/usage-receipt.schema.json -d examples/receipt.example.json -c ajv-formats
```

---

### 4. Generate and verify a signed receipt (Python)

Generate a real signed example receipt (UUID-based `request_id` ensures schema validity):  
```bash
python scripts/sign_example_receipt.py
```

Verify it with the bundled public key:  
```bash
python packages/receipt-verifier-py/verify.py examples/receipt.example.json keys/publisher.pub
```

(Optional) Validate the generated receipt against schema to confirm it passes structural checks:  
```bash
npx ajv validate --spec=draft2020 -s schemas/usage-receipt.schema.json -d examples/receipt.example.json -c ajv-formats
```

---

## ğŸ“œ Standards Alignment

| Concept                        | Implemented As                          |
|--------------------------------|-----------------------------------------|
| **Licensing Manifest**         | `/.well-known/agent-licensing.json`      |
| **Pricing Surface**            | `apifee.json` + `schemas/apifee.schema.json` |
| **Usage Receipts**             | `X-Usage-Receipt` header (signed, JSON schema in `schemas/usage-receipt.schema.json`) |
| **Edge Enforcement**           | Cloudflare Worker (`examples/cloudflare-worker.js`), NGINX snippet |
| **Training vs Inference Flags**| `permissions.training / inference` in manifest |
| **Dispute Handling**           | `disputes.url` + `disputes.email`        |
| **Provenance (future)**        | planned C2PA-style receipt extensions   |

---

## ğŸ“‚ Repo Structure

```
ai-native-template/
â”œâ”€â”€ .well-known/
â”‚   â””â”€â”€ agent-licensing.json
â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ apifee.schema.json         # Fee menu schema
â”‚   â””â”€â”€ usage-receipt.schema.json  # Receipt schema
â”œâ”€â”€ apifee.json                    # Sample fee manifest (validates against schema)
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ receipt-verifier-ts/       # TypeScript verifier
â”‚   â””â”€â”€ receipt-verifier-py/       # Python verifier
â”‚       â””â”€â”€ verify.py
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ sign_example_receipt.py    # Helper to generate signed receipts
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ receipt.example.json       # Generated by signer script
â”‚   â”œâ”€â”€ openweather_adapter/       # API adapter demo
â”‚   â”œâ”€â”€ static_site_publisher/     # Markdown static site demo
â”‚   â”œâ”€â”€ cloudflare-worker.js       # Edge enforcement
â”‚   â””â”€â”€ nginx.conf                 # NGINX snippet
â”œâ”€â”€ tests/                         # Pytest-based validation
â”œâ”€â”€ ROADMAP.md
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ SECURITY.md
â”œâ”€â”€ CODEOWNERS
â”œâ”€â”€ SPEC-REFERENCES.md
â”œâ”€â”€ ADOPTERS.md
â””â”€â”€ LICENSE
```

---

## ğŸ§¾ Usage Receipts

Every response can include an `X-Usage-Receipt` header:

```http
X-Usage-Receipt: eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...
```

### Receipt Schema (simplified)

```json
{
  "request_id": "req_01HZZ5A3H3QJCPX4",
  "publisher_id": "urn:publisher:oozle.ai-native-template",
  "resource_id": "kb/article/42",
  "units": { "unit": "1k_tokens", "value": 1.7 },
  "fee_computed": 0.0017,
  "ts": "2025-09-30T22:15:00Z",
  "alg": "Ed25519",
  "signature": "BASE64_SIGNATURE"
}
```

Agents can verify receipts using the Python verifier provided.

---

## ğŸ›¡ï¸ Edge Enforcement

Block AI crawlers unless they present valid receipts.

### Cloudflare Worker

```js
export default {
  async fetch(request) {
    const url = new URL(request.url);
    if (url.pathname.startsWith('/api/')) {
      const receipt = request.headers.get('X-Usage-Receipt');
      if (!receipt) {
        return new Response(JSON.stringify({
          error: "Payment required",
          manifest: "https://oozle.github.io/ai-native-template/.well-known/agent-licensing.json"
        }), { status: 402, headers: { "content-type": "application/json" }});
      }
    }
    return fetch(request);
  }
};
```

### NGINX Snippet

```nginx
location /api/ {
  if ($http_x_usage_receipt = "") {
    return 402 '{"error":"Payment required","manifest":"https://oozle.github.io/ai-native-template/.well-known/agent-licensing.json"}';
  }
  proxy_pass http://origin_upstream;
}
```

---

## ğŸ›£ï¸ Roadmap

See [ROADMAP.md](ROADMAP.md) for detailed milestones.  

Highlights:  
- **v0.1 (MVP):** Schemas, receipts, manifest, edge enforcement  
- **v0.2:** Metering plugins, SDKs, batch receipts  
- **v0.3:** Clearing hooks, dispute stubs, per-publisher keys  
- **v1.0:** Full clearing API, multi-protocol adapter, provenance extensions  

---

## ğŸ“ˆ Governance & Specs

- [ADOPTERS.md](ADOPTERS.md) â€” adopters and experiments  
- [CONTRIBUTING.md](CONTRIBUTING.md) â€” how to contribute  
- [SECURITY.md](SECURITY.md) â€” threat model & reporting  
- [CODEOWNERS](CODEOWNERS) â€” repo ownership  
- [SPEC-REFERENCES.md](SPEC-REFERENCES.md) â€” CoMP, RSL, Cloudflare, C2PA links  

---

## ğŸ”® Vision

The web is shifting from **attention/ads â†’ transaction/licensing**.  
AI agents consume content at scale â€” publishers need **transparent compensation**.  

This OSS project aims to:  
1. Lower the barrier for publishers to expose terms and pricing.  
2. Provide agents with verifiable receipts and predictable costs.  
3. Enable clearinghouses and mediators to reconcile usage fairly.  

---

## ğŸ“¬ Contact

Maintainer: [GitHub @oozle](https://github.com/oozle)  
Live Manifest: [agent-licensing.json](https://oozle.github.io/ai-native-template/.well-known/agent-licensing.json)  
Raw JSON: [raw.githubusercontent link](https://raw.githubusercontent.com/oozle/ai-native-template/main/.well-known/agent-licensing.json)

---
